// ============================================
// DRAGGABLE OVERLAY PANELS
// ============================================

@use "../abstracts" as *;

.exoplanet-overlay-panel {
  @include panel-overlay;

  &.minimized {
    max-height: auto;

    .exoplanet-panel-content {
      display: none;
    }

    .exoplanet-panel-header {
      border-radius: $radius-2xl;
      cursor: grab;
      padding: $spacing-lg $spacing-xl;

      // Keep tabs visible but make them non-interactive when minimized
      .exoplanet-panel-tabs {
        .nav-link {
          cursor: grab;
          pointer-events: none;
        }
      }

      // Change to up chevron when minimized
      .exoplanet-minimize-icon {
        font-family: inherit;
        font-size: 0; // Hide the minus text

        &::before {
          content: "^"; // Simple up chevron
          font-size: 1.4rem;
          font-weight: bold;
        }
      }
    }
  }
}

.exoplanet-combined-panel {
  top: $spacing-xl;
  left: $spacing-xl;
  width: 420px;
  max-width: calc(100vw - 40px);
}

.exoplanet-panel-header {
  padding: $spacing-md $spacing-lg;
  border-bottom: 1px solid $border-subtle;
  @include flex-between;
  cursor: move;
  user-select: none;
  background: $overlay-light;
  border-radius: $radius-2xl $radius-2xl 0 0;
  gap: $spacing-md;

  &:hover {
    background: rgba(255, 255, 255, 0.08);
  }

  h5 {
    margin: 0;
    font-size: 1.1rem;
    font-weight: 600;
    @include flex-center;
    color: $text-white;
  }

  i {
    opacity: 0.9;
  }
}

// ============================================
// NAV TABS (OVERRIDE BOOTSTRAP)
// ============================================

.exoplanet-overlay-panel .exoplanet-panel-header .nav-tabs,
.exoplanet-combined-panel
  .exoplanet-panel-header
  .exoplanet-panel-tabs.nav.nav-tabs,
.exoplanet-panel-header .exoplanet-panel-tabs.nav.nav-tabs {
  margin: 0 !important;
  padding: 0 !important;
  border: none !important;
  border-bottom: none !important;
  background: none !important;
  background-image: none !important;
  display: flex;
  gap: $spacing-xs;

  // Remove any underlines or borders
  &::before,
  &::after {
    display: none !important;
    content: none !important;
  }

  .nav-item {
    margin: 0 !important;
    margin-bottom: 0 !important;
    background: none !important;
    border: none !important;
  }

  .nav-link,
  button.nav-link {
    // Complete reset
    margin: 0 !important;
    border: none !important;
    border-bottom: none !important;
    border-radius: $radius-lg !important;
    background: transparent !important;
    background-image: none !important;
    background-color: transparent !important;
    color: $text-muted !important;
    padding: 10px $spacing-xl !important;
    transition: all $transition-slow $easing-standard !important;
    font-size: 0.9rem !important;
    cursor: pointer !important;
    position: relative !important;
    white-space: nowrap !important;
    text-decoration: none !important;
    display: flex !important;
    align-items: center !important;
    box-shadow: none !important;
    outline: none !important;

    // Glassmorphic effect on hover
    &:hover:not(.active) {
      background: rgba(255, 255, 255, 0.06) !important;
      background-image: none !important;
      backdrop-filter: blur(8px) !important;
      color: rgba(255, 255, 255, 0.85) !important;
      box-shadow: inset 0 0 20px rgba(255, 255, 255, 0.05) !important;
      border: none !important;
    }

    // Active tab - prominent glassmorphic effect
    &.active {
      @include glassmorphism-light(0.15, 12px);
      background: $overlay-medium !important;
      background-image: none !important;
      background-color: $overlay-medium !important;
      color: $text-white !important;
      font-weight: 500 !important;
      box-shadow: $shadow-md, inset 0 1px 0 rgba(255, 255, 255, 0.2),
        inset 0 0 20px rgba(255, 255, 255, 0.08) !important;
      border: 1px solid $border-light !important;
    }

    // Remove focus styles
    &:focus,
    &:focus-visible,
    &:active {
      box-shadow: $shadow-md, inset 0 1px 0 rgba(255, 255, 255, 0.2),
        inset 0 0 20px rgba(255, 255, 255, 0.08) !important;
      outline: none !important;
      border: none !important;
    }

    &.active:focus,
    &.active:focus-visible {
      background: $overlay-medium !important;
      color: $text-white !important;
    }

    // Icon styling - space theme
    i {
      font-size: 1.1rem !important;
      opacity: 0.9 !important;
      color: inherit !important;
      margin-right: 6px !important;
    }

    &.active i {
      opacity: 1 !important;
      filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.3)) !important;
    }
  }
}

.exoplanet-panel-controls {
  display: flex;
  gap: $spacing-sm;
  align-items: center;

  .btn-link {
    opacity: 0.7;
    @include transition-multiple(
      opacity $transition-normal $easing-standard,
      transform $transition-normal $easing-standard
    );

    &:hover {
      opacity: 1;
      transform: scale(1.1);
    }
  }

  .exoplanet-minimize-icon {
    font-size: 1.4rem;
    font-weight: normal;
    display: inline-block;
    line-height: 1;
    @include transition(transform, $transition-normal, $easing-standard);
  }
}

.exoplanet-panel-content {
  overflow-y: auto;
  overflow-x: hidden;
  flex: 1 1 auto;
  min-height: 200px;

  .tab-content {
    height: 100%;
  }

  .tab-pane {
    &.show,
    &.active {
      display: block !important;
      opacity: 1 !important;
    }

    &.fade {
      transition: opacity $transition-fast linear !important;

      &:not(.show) {
        opacity: 0;
        display: none !important;
      }
    }
  }

  // Custom scrollbar
  @include custom-scrollbar;

  // Text muted in panels
  .text-muted {
    color: $text-muted !important;
  }

  // Update h5 and h6 colors
  h5,
  h6 {
    color: $text-white;
  }

  // Button styling for dark panel
  .btn-outline-primary {
    border-color: rgba($color-primary, 0.5);
    color: $color-primary;

    &:hover {
      background-color: $color-primary;
      border-color: $color-primary;
      color: $text-white;
    }
  }

  .btn-outline-secondary {
    border-color: $border-strong;
    color: rgba(255, 255, 255, 0.8);

    &:hover {
      background-color: $overlay-medium;
      border-color: rgba(255, 255, 255, 0.5);
      color: $text-white;
    }
  }
}

// ============================================
// RESULTS LIST IN PANELS
// ============================================

.exoplanet-viewer-page {
  .exoplanet-panel-content .list-group-item {
    cursor: pointer;
    @include transition(all, $transition-normal, $easing-standard);
    border-left: 3px solid transparent;
    background-color: $overlay-light;
    color: $text-white;
    border: 1px solid $border-subtle;

    &:hover {
      background-color: $overlay-medium;
      border-left-color: $color-primary;
      transform: translateX(2px);
      color: $text-white;
    }

    &:active {
      background-color: $overlay-medium;
      color: $text-white;
    }

    &.active {
      background-color: $color-primary;
      color: $text-white;
      border-left-color: $color-primary;

      .text-muted {
        color: rgba(255, 255, 255, 0.8) !important;
      }

      .badge {
        background-color: rgba(255, 255, 255, 0.2) !important;
        color: $text-white !important;
        border-color: $border-strong !important;
      }
    }

    .badge {
      font-size: 0.7rem;
      padding: 0.25rem 0.5rem;
    }

    .fw-semibold {
      font-weight: 600;
    }

    .fs-sm {
      font-size: 0.875rem;
    }
  }
}

// ============================================
// INFO TABS (GALAXY/SYSTEM/PLANET)
// ============================================

.info-galaxy,
.info-system,
.info-planet {
  h5,
  h6 {
    color: $text-white;
  }

  .info-section {
    margin-bottom: 1.5rem;

    &:last-child {
      margin-bottom: 0;
    }
  }

  .stat-item,
  .property-item,
  .planet-item {
    @include transition(all, $transition-normal, $easing-standard);

    &:hover {
      background: rgba(255, 255, 255, 0.08) !important;
      transform: translateX(2px);
    }
  }

  .planet-list {
    // Custom scrollbar for planet list
    @include custom-scrollbar($scrollbar-width-thin);
  }

  .planet-item {
    cursor: pointer;

    &:hover {
      background: rgba(255, 255, 255, 0.08) !important;
    }
  }
}

// ============================================
// PANEL RESPONSIVE
// ============================================

@include respond-to-md {
  .exoplanet-combined-panel {
    width: 90vw;
    max-width: 90vw;
    max-height: 70vh;
    left: 5vw;
  }
}

@include respond-to-xs {
  .exoplanet-combined-panel {
    width: calc(100vw - 20px);
    max-width: calc(100vw - 20px);
    left: 10px !important;
    max-height: 60vh;
    top: 80px; // Below instructions pane
  }
}

// ============================================
// TOOLS TAB - MINIMALIST CARD LAYOUT
// ============================================

.tools-tab-container {
  background: transparent;
}

.tools-card-grid {
  display: flex;
  flex-direction: column;
  gap: $spacing-xl;
  padding: $spacing-xs 0;
}

.tool-card {
  background: $overlay-light;
  border: 1px solid $border-subtle;
  border-radius: $radius-xl;
  overflow: hidden;
  @include transition(all, $transition-normal, $easing-standard);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);

  &:hover {
    border-color: $border-light;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
    transform: translateY(-2px);
  }
}

.tool-card-header {
  display: flex;
  align-items: center;
  gap: $spacing-md;
  padding: $spacing-lg $spacing-xl;
  background: $overlay-medium;
  border-bottom: 1px solid $border-subtle;
  @include transition(background, $transition-fast, $easing-standard);

  .tool-card:hover & {
    background: rgba(255, 255, 255, 0.12);
  }
}

.tool-card-icon {
  font-size: 1.5rem;
  color: $color-primary;
  opacity: 0.9;
  @include transition(all, $transition-normal, $easing-standard);

  .tool-card:hover & {
    opacity: 1;
    transform: scale(1.1);
    filter: drop-shadow(0 0 8px rgba($color-primary, 0.4));
  }
}

.tool-card-title {
  margin: 0;
  font-size: 1rem;
  font-weight: 600;
  color: $text-white;
  letter-spacing: 0.02em;
}

.tool-card-body {
  padding: $spacing-xl;
  color: $text-white;

  // Ensure child components have proper spacing
  > *:last-child {
    margin-bottom: 0;
  }

  // Override any excessive margins from child components
  h5, h6 {
    margin-top: 0;
    margin-bottom: $spacing-md;
  }

  p {
    margin-bottom: $spacing-md;
  }

  // Button group spacing
  .btn-group,
  .d-flex {
    gap: $spacing-sm;
  }

  // Form elements
  .form-control,
  .form-select {
    background: rgba(0, 0, 0, 0.3);
    border-color: $border-subtle;
    color: $text-white;

    &:focus {
      background: rgba(0, 0, 0, 0.4);
      border-color: $color-primary;
      box-shadow: 0 0 0 0.2rem rgba($color-primary, 0.25);
      color: $text-white;
    }

    &::placeholder {
      color: $text-muted;
    }
  }

  // Lists within cards
  .list-group {
    background: transparent;

    .list-group-item {
      background: rgba(0, 0, 0, 0.2);
      border-color: $border-subtle;
      color: $text-white;

      &:hover {
        background: rgba(0, 0, 0, 0.35);
      }
    }
  }

  // Empty state styling
  .text-muted {
    color: $text-muted !important;
    font-style: italic;
  }
}

// Responsive adjustments for tool cards
@include respond-to-md {
  .tools-card-grid {
    gap: $spacing-lg;
  }

  .tool-card-header {
    padding: $spacing-md $spacing-lg;
  }

  .tool-card-body {
    padding: $spacing-lg;
  }
}

@include respond-to-xs {
  .tools-card-grid {
    gap: $spacing-md;
  }

  .tool-card-header {
    padding: $spacing-sm $spacing-md;
  }

  .tool-card-icon {
    font-size: 1.25rem;
  }

  .tool-card-title {
    font-size: 0.9rem;
  }

  .tool-card-body {
    padding: $spacing-md;
  }
}
